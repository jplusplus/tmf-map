"use strict";angular.module("tmfMap",["ngAnimate","ngTouch","ngSanitize","ngCookies","pascalprecht.translate"]),angular.module("tmfMap").directive("main",["main",function(a){return{controller:"MainCtrl",templateUrl:"app/main/main.html",restrict:"EA",link:function(e,n){var t=n.find(".main__map");cartodb.createVis(t[0],a.viz).done(function(n,t){t[1].getSubLayer(0).setInteractivity(a.interactivity),t[1].on("featureClick",function(a,n,t,i){e.$apply(function(){e.$broadcast("feature:click",i)})}),e.$apply(function(){e.$broadcast("map:loaded",[n,t])})})}}}]),angular.module("tmfMap").controller("MainCtrl",["$scope","main",function(a,e){a.dataset=e.dataset,a.$on("feature:click",function(e,n){a.selectedEntry=n,a.showSidebar=!0}),a.$on("map:loaded",function(a,e){var n=(e[0],e[1]);n[1].getSubLayer(0).infowindow.clear()})}]),angular.module("tmfMap").constant("main",{interactivity:["cartodb_id","deaths","lat","long"],viz:"http://jplusplus.cartodb.com/api/v2/viz/9284b33a-e903-11e4-8de1-0e0c41326911/viz.json",dataset:"https://jplusplus.cartodb.com/tables/the_migrants_files_refugees_and_migrants_who_d/public"}),angular.module("tmfMap").config(["$translateProvider","index",function(a,e){_.forEach(e.languages,function(e,n){a.translations(n,e)}),a.registerAvailableLanguageKeys(_.keys(e.languages)).determinePreferredLanguage().fallbackLanguage(e.fallbackLanguage).useCookieStorage()}]),angular.module("tmfMap").run(["$translate","$location","index",function(a,e,n){var t=e.search().lang;t&&_.keys(n.languages).indexOf(t)>-1&&a.use(t)}]),angular.module("tmfMap").config(["$locationProvider",function(a){a.html5Mode(!0)}]),angular.module("tmfMap").constant("index",{fallbackLanguage:["en_US"],languages:{en_US:{APP_TITLE:"The Migrants' Files - EN",INFOWINDOW_CONTENT:"{{ deaths }} refugees and migrants died at this location between 2000 and April 20,2015."},fr_FR:{APP_TITLE:"The Migrants' Files - FR",INFOWINDOW_CONTENT:"{{ deaths }} refugees and migrants died at this location between 2000 and April 20,2015."}}}),angular.module("tmfMap").run(["$templateCache",function(a){a.put("app/main/main.html",'<div class="main"><div class="main__map"></div><div class="main__sidebar" ng-show="showSidebar"><a class="main__sidebar__close" ng-click="showSidebar = false">&times; <span class="sr-only">close</span></a><div class="main__sidebar__body"><p class="lead">{{ \'INFOWINDOW_CONTENT\' | translate:selectedEntry }}</p></div><div class="main__sidebar__download"><a class="btn btn-block btn-lg" href="{{ dataset }}" target="_blank">See the whole dataset</a></div></div></div>')}]);